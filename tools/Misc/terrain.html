<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Projectile Penetration Visualization</title>
<style>
  body { margin: 0; overflow: hidden; background: #111; }
</style>
</head>
<body>
<script src="https://cdn.jsdelivr.net/npm/three@0.158.0/build/three.min.js"></script>
<script>
// Scene setup
const scene = new THREE.Scene();
scene.background = new THREE.Color(0x111111);

// Camera setup (fixed, no orbit controls)
const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 5000);
camera.position.set(0, 100, 600);
camera.lookAt(0, 0, 0);

// Renderer
const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

// Lights
const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
scene.add(ambientLight);
const dirLight = new THREE.DirectionalLight(0xffffff, 1);
dirLight.position.set(200, 500, 300);
scene.add(dirLight);

// Define blocks (armor targets)
const blockMaterial = new THREE.MeshStandardMaterial({color: 0x4444ff});
const blocks = [];
const numBlocks = 6;
for(let i=0; i<numBlocks; i++){
    const geometry = new THREE.BoxGeometry(50, 50, 50);
    const block = new THREE.Mesh(geometry, blockMaterial);
    block.position.set(i*60 - 150, 0, 0);
    scene.add(block);
    blocks.push(block);
}

// Define shells (projectiles)
const shellMaterial = new THREE.MeshStandardMaterial({color: 0xff4444});
const shells = [];

// Example shell data (mass, penetration factor)
const shellData = [
    {mass: 0.05, pen: 1.5},
    {mass: 6, pen: 7.5},
    {mass: 20, pen: 49},
    {mass: 1190, pen: 35},
    {mass: 6047, pen: 157},
];

shellData.forEach((s, i)=>{
    const geometry = new THREE.SphereGeometry(5, 16, 16);
    const shell = new THREE.Mesh(geometry, shellMaterial);
    shell.position.set(-300, 0, 50*i);
    shell.userData = { targetX: blocks[i%blocks.length].position.x, pen: s.pen, speed: 1 + s.mass/1000 };
    scene.add(shell);
    shells.push(shell);
});

// Animate shells hitting blocks
function animate() {
    requestAnimationFrame(animate);

    shells.forEach(shell=>{
        const dx = shell.userData.targetX - shell.position.x;
        if(Math.abs(dx) > 0.5){
            shell.position.x += Math.sign(dx) * shell.userData.speed;
        } else {
            // “Blast” the block based on penetration
            const block = blocks.find(b=>Math.abs(b.position.x - shell.userData.targetX)<1);
            if(block){
                block.scale.z = Math.max(0.1, block.scale.z - shell.userData.pen/50);
            }
        }
    });

    renderer.render(scene, camera);
}

animate();

// Handle resizing
window.addEventListener('resize', ()=>{
    camera.aspect = window.innerWidth/window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);
});
</script>
</body>
</html>