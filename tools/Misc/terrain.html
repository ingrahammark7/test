<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Exploding Pattern</title>
<style>
  body { margin:0; overflow:hidden; background:#101020; }
  canvas { display:block; }
</style>
</head>
<body>
<canvas id="canvas"></canvas>
<script>
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');

function resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
window.addEventListener('resize', resize);
resize();

const centerX = canvas.width/2;
const centerY = canvas.height/2;

// Particles
let particles = [];
let startTime = performance.now();
let N0 = 1;
let fps = 60;
let lastFrameTime = performance.now();
const targetFPS = 50;

// Initialize particles along a cross pattern
function initParticles(count) {
  for(let i=0;i<count;i++){
    const angle = (i/20)*Math.PI/2; // Spread along cross arms
    const radius = Math.random()*20+10;
    particles.push({
      x: centerX + radius*Math.cos(angle),
      y: centerY + radius*Math.sin(angle),
      vx: Math.cos(angle)*0.5,
      vy: Math.sin(angle)*0.5,
      color: `hsl(${Math.random()*360},100%,60%)`,
      size: Math.random()*3+2
    });
  }
}

// Update particles with exponential growth
function updateParticles() {
  const now = performance.now();
  const elapsedMs = now - startTime;
  fps = 1000 / (now - lastFrameTime);
  lastFrameTime = now;

  // Exponential growth every ms
  let targetCount = Math.floor(N0 * Math.pow(2, elapsedMs / 50)); // slower than 1ms for performance
  if(fps <= targetFPS) targetCount = particles.length;

  while(particles.length < targetCount){
    const angle = Math.random()*2*Math.PI;
    const radius = Math.random()*10;
    particles.push({
      x: centerX + radius*Math.cos(angle),
      y: centerY + radius*Math.sin(angle),
      vx: Math.cos(angle)*0.5,
      vy: Math.sin(angle)*0.5,
      color: `hsl(${Math.random()*360},100%,60%)`,
      size: Math.random()*3+2
    });
  }

  // Move particles
  particles.forEach(p=>{
    p.x += p.vx;
    p.y += p.vy;
    // Optional: slow down or bounce at edges
  });
}

// Draw particles
function drawParticles() {
  particles.forEach(p=>{
    ctx.beginPath();
    ctx.arc(p.x,p.y,p.size,0,2*Math.PI);
    ctx.fillStyle = p.color;
    ctx.fill();
  });
}

// Animate
function animate(){
  requestAnimationFrame(animate);
  ctx.clearRect(0,0,canvas.width,canvas.height);

  updateParticles();
  drawParticles();

  // Display FPS and particle count
  ctx.fillStyle = "#ffffff";
  ctx.font = "18px monospace";
  ctx.fillText(`FPS: ${fps.toFixed(1)}`, 10, 24);
  ctx.fillText(`Particles: ${particles.length}`, 10, 44);
}

initParticles(20);
animate();
</script>
</body>
</html>