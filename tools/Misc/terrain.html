<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Exploding Dollar</title>
<style>
  body { margin:0; overflow:hidden; background:#101020; }
  canvas { display:block; }
</style>
</head>
<body>
<canvas id="canvas"></canvas>
<script>
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');

function resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
window.addEventListener('resize', resize);
resize();

const centerX = canvas.width/2;
const centerY = canvas.height/2;

// Particles
let particles = [];
let N0 = 1; // starting particles
let startTime = performance.now();
let fps = 60;
let lastFrameTime = performance.now();
const targetFPS = 50;

// Initialize particles along the dollar symbol
function initParticles(count) {
  ctx.font = "120px monospace";
  const textMetrics = ctx.measureText("$");
  const width = textMetrics.width;
  const height = 120;
  
  // Sample points along the text
  for(let i=0;i<count;i++){
    const x = centerX - width/2 + Math.random()*width;
    const y = centerY - height/2 + Math.random()*height;
    particles.push({
      x, y,
      vx: (Math.random()-0.5)*2,
      vy: (Math.random()-0.5)*2,
      color: `hsl(${Math.random()*360},100%,60%)`,
      size: Math.random()*3+2
    });
  }
}

// Update particles with exponential growth
function updateParticles() {
  const now = performance.now();
  const elapsedMs = now - startTime;
  fps = 1000 / (now - lastFrameTime);
  lastFrameTime = now;
  
  let targetCount = Math.floor(N0 * Math.pow(2, elapsedMs / 50)); // slower than 1ms
  if(fps <= targetFPS) targetCount = particles.length;

  while(particles.length < targetCount){
    particles.push({
      x: centerX,
      y: centerY,
      vx: (Math.random()-0.5)*2,
      vy: (Math.random()-0.5)*2,
      color: `hsl(${Math.random()*360},100%,60%)`,
      size: Math.random()*3+2
    });
  }

  // Move particles
  particles.forEach(p=>{
    p.x += p.vx;
    p.y += p.vy;
  });
}

// Draw particles
function drawParticles() {
  particles.forEach(p=>{
    ctx.beginPath();
    ctx.arc(p.x,p.y,p.size,0,2*Math.PI);
    ctx.fillStyle = p.color;
    ctx.fill();
  });
}

// Animate
function animate(){
  requestAnimationFrame(animate);
  ctx.clearRect(0,0,canvas.width,canvas.height);

  updateParticles();
  drawParticles();

  // Display FPS and particle count
  ctx.fillStyle = "#ffffff";
  ctx.font = "18px monospace";
  ctx.fillText(`FPS: ${fps.toFixed(1)}`, 10, 24);
  ctx.fillText(`Particles: ${particles.length}`, 10, 44);
}

initParticles(20);
animate();
</script>
</body>
</html>